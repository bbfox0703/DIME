forked from https://github.com/jrywu/DIME
for my own purpose only
